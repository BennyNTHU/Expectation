# 周邊收集期望值計算器

本程式旨在解決一個與機率論中幾何分佈及彩票問題相關的經典問題，也就是所謂的 **Coupon Collector's Problem（集郵問題）**。假設 LL 今天推出了 N 款不同的小周邊，每次購買時隨機出貨，程式可幫助你計算集滿所有 N 款周邊所需購買的期望數量。

---

## 數學原理

### Coupon Collector's Problem（集郵問題）

在集郵問題中，假設有 N 種不同的獎品，每次隨機獲得一款獎品，且每款出現的機率均等（均為 1/N）。當你已擁有 k 款不同的獎品時，再獲得一款新獎品的機率為：

<p align="center">
  p = (N - k) / N
</p>

根據幾何分佈的性質，當成功機率為 p 時，第一次成功所需的嘗試次數的期望值為 1/p。因此，當你已有 k 款獎品時，獲得下一款新獎品所需的期望購買次數為：

<p align="center">
  E<sub>k</sub> = 1 / p = N / (N - k)
</p>

要集滿所有 N 款獎品，其總期望購買數量 E 為各階段期望值的累計和，即：

<p align="center">
  E = ∑<sub>k=0</sub><sup>N-1</sup> (N / (N - k)) = N × (1 + 1/2 + 1/3 + ... + 1/N)
</p>

這裡，(1 + 1/2 + 1/3 + ... + 1/N) 為第 N 個調和數。隨著 N 增大，調和數的成長趨勢近似於 ln(N) + γ，其中 γ 為歐拉常數（約 0.57721）。

### 幾何分佈的應用

在本問題中，每次購買的結果可視為一個獨立的伯努利試驗：
- **成功**：獲得一款尚未收藏的新獎品，成功機率 p = (N - k) / N。
- **失敗**：獲得重複的獎品。

由於每個階段（從已收集 k 款到新增一款）的購買次數皆服從幾何分佈，因此其期望值為 N / (N - k)，最終將所有階段的期望值相加即得到整個集滿過程的期望購買次數。

---

## 使用方法

1. **環境需求**  
   - Python 3.x  
   - Jupyter Notebook（若欲以 Notebook 執行）

2. **安裝與執行**  
   - 將本程式（包含 `expectation.ipynb`）下載到本地環境。  
   - 開啟 `expectation.ipynb` 並依序執行各程式區塊。  
   - 根據提示輸入不同的 N 值，程式將計算並輸出集滿所有周邊的期望購買數量。

3. **模擬方式**  
   除了理論計算，本程式也提供了利用蒙地卡羅方法進行模擬的功能。透過大量實驗，可驗證理論期望值與實際模擬結果的一致性。

---

## 程式結構

- **理論計算部分**  
  利用數學公式直接計算期望值：
  - 計算調和數：H<sub>N</sub> = 1 + 1/2 + 1/3 + ... + 1/N  
  - 期望購買數量：E = N × H<sub>N</sub>

- **模擬實驗部分**  
  通過隨機試驗模擬購買過程，統計多次實驗後達到集滿 N 款周邊所需購買數量的平均值。

- **結果輸出**  
  最終同時展示理論計算結果與模擬結果，方便比較與驗證數學模型的準確性。

---

## 範例說明

以 N = 10 為例：
- **理論計算**  
  期望購買數量 E = 10 × (1 + 1/2 + 1/3 + ... + 1/10)  
  約略結果為 29.29 次購買。

- **模擬結果**  
  通過多次隨機模擬，計算出的平均購買次數應接近 29 次左右，與理論值吻合。

---

## 參考資料

- [Coupon Collector's Problem - Wikipedia](https://en.wikipedia.org/wiki/Coupon_collector%27s_problem)
- [Geometric Distribution - Wikipedia](https://en.wikipedia.org/wiki/Geometric_distribution)

---

## 授權

本程式採用 [MIT License](LICENSE)（若適用）進行授權，請參閱 LICENSE 文件以獲取詳細資訊。

---

歡迎提供問題與建議，感謝您的使用！
